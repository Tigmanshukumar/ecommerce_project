<%- include('./partials/header') %>


<% if(success && success.length > 0){ %>
    <div class="fixed top-20 left-1/2 transform -translate-x-1/2 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg">
        <div class="flex items-center">
            <i class="ri-check-line mr-2"></i>
            <%= success %>
        </div>
    </div>
<% } %>


<div class="bg-tech-dark text-white py-8">
    <div class="max-w-7xl mx-auto px-4">
        <h1 class="text-3xl font-bold mb-4">PC Components Store</h1>
        <p class="text-gray-300 mb-6">Build your dream setup with premium components</p>
        
      
        <div class="max-w-md">
            <form action="/shop" method="GET" class="relative">
                <input type="text" name="search" value="<%= searchQuery %>" 
                       placeholder="Search for CPUs, GPUs, RAM..." 
                       class="w-full px-4 py-3 pl-12 text-gray-900 rounded-lg focus:ring-2 focus:ring-blue-500">
                <i class="ri-search-line absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                <button type="submit" 
                        class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-blue-600 text-white px-4 py-1 rounded">
                    Search
                </button>
            </form>
        </div>
    </div>
</div>

<div class="max-w-7xl mx-auto px-4 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
        
        <div class="lg:w-1/4">
            <div class="bg-white rounded-lg shadow-md p-6 sticky top-4">
                
                <div class="mb-6">
                    <h3 class="font-semibold text-lg mb-4 flex items-center">
                        <i class="ri-list-check mr-2 text-blue-600"></i>Categories
                    </h3>
                    <div class="space-y-2">
                        <a href="/shop" class="block py-2 px-3 rounded hover:bg-blue-50 transition-colors">
                            <i class="ri-apps-line mr-2"></i>All Products
                        </a>
                        <a href="/shop?category=prebuiltpc" class="block py-2 px-3 rounded hover:bg-blue-50 transition-colors">
                            <i class="ri-computer-line mr-2"></i>Pre Built PC
                        </a>
                        <a href="/shop?category=cpu" class="block py-2 px-3 rounded hover:bg-blue-50 transition-colors">
                            <i class="ri-cpu-line mr-2"></i>Processors (CPU)
                        </a>
                                                <a href="/shop?category=gpu" class="block py-2 px-3 rounded hover:bg-blue-50 transition-colors">
                            <i class="ri-gamepad-line mr-2"></i>Graphics Cards
                        </a>
                        <a href="/shop?category=ram" class="block py-2 px-3 rounded hover:bg-blue-50 transition-colors">
                            <i class="ri-ram-line mr-2"></i>Memory (RAM)
                        </a>
                        <a href="/shop?category=storage" class="block py-2 px-3 rounded hover:bg-blue-50 transition-colors">
                            <i class="ri-hard-drive-line mr-2"></i>Storage
                        </a>
                        <a href="/shop?category=motherboard" class="block py-2 px-3 rounded hover:bg-blue-50 transition-colors">
                            <i class="ri-artboard-2-line mr-2"></i>Motherboards
                        </a>
                    </div>
                </div>

               
                <div class="mb-6">
                    <h3 class="font-semibold text-lg mb-4 flex items-center">
                        <i class="ri-sort-asc mr-2 text-green-600"></i>Sort By
                    </h3>
                    <form action="/shop" method="GET">
                        <select name="sortby" onchange="this.form.submit()" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="newest">Newest First</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                            <option value="popular">Most Popular</option>
                        </select>
                    </form>
                </div>

                
                <div>
                    <h3 class="font-semibold text-lg mb-4 flex items-center">
                        <i class="ri-price-tag-line mr-2 text-purple-600"></i>Price Range
                    </h3>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">Under ₹25,000
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">₹25,000 - ₹45,000
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">₹45,000 - ₹150,000
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">Above ₹150,000
                        </label>
                    </div>
                </div>
            </div>
        </div>

       
        <div class="lg:w-3/4">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold">
                    <% if(products && products.length > 0) { %>
                        Showing <%= products.length %> Products
                    <% } else { %>
                        No Products Found
                    <% } %>
                </h2>
                <div class="flex items-center space-x-2">
                    <button class="p-2 border rounded hover:bg-gray-50" title="Grid View">
                        <i class="ri-grid-line"></i>
                    </button>
                    <button class="p-2 border rounded hover:bg-gray-50" title="List View">
                        <i class="ri-list-line"></i>
                    </button>
                </div>
            </div>

            <% if(products && products.length > 0) { %>
                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                    <% products.forEach(function(product){ %>
                        <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
                            
                            <div class="h-48 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center p-4">
                                <img class="max-h-full max-w-full object-contain" 
                                     src="data:image/jpeg;base64,<%= product.image.toString('base64') %>"
                                     alt="<%= product.name %>">
                            </div>
                            
                           
                            <div class="p-4">
                                <h3 class="font-semibold text-lg mb-2 text-gray-800 line-clamp-2">
                                    <%= product.name %>
                                </h3>
                                
                             
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-2">
                                        <span class="text-2xl font-bold text-green-600">₹<%= product.price %></span>
                                        <% if(product.discount > 0) { %>
                                            <span class="text-sm text-gray-500 line-through">₹<%= product.price + product.discount %></span>
                                            <span class="bg-red-100 text-red-600 text-xs px-2 py-1 rounded">
                                                ₹<%= product.discount %> OFF
                                            </span>
                                        <% } %>
                                    </div>
                                </div>
                         
                                <button onclick="addToCart('<%= product._id %>')" 
                                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center justify-center">
                                    <i class="ri-shopping-cart-line mr-2"></i>Add to Cart
                                </button>
                            </div>
                        </div>
                    <% }) %>
                </div>
            <% } else { %>
              
                <div class="text-center py-16">
                    <i class="ri-shopping-bag-line text-6xl text-gray-300 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-600 mb-2">No Products Available</h3>
                    <p class="text-gray-500 mb-6">Check back later for new PC components</p>
                    <a href="/shop" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        Go Back Home
                    </a>
                </div>
            <% } %>
        </div>
    </div>
</div>

<script>
    function addToCart(productId) {
      
        event.target.innerHTML = '<i class="ri-loader-line animate-spin mr-2"></i>Adding...';
        event.target.disabled = true;
        
      
        window.location.href = '/addtocart/' + productId;
    }
    
   
    setTimeout(function() {
        const flashMessages = document.querySelectorAll('.fixed.top-20');
        flashMessages.forEach(function(msg) {
            msg.style.display = 'none';
        });
    }, 3000);
</script>

<%- include('./partials/footer') %>